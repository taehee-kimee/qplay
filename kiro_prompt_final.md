# 퀴즈 게임 자동 답변 프로그램 개발

## 프로젝트 개요
게임 화면에 표시되는 퀴즈 문제를 실시간으로 인식하고 즉시 답을 찾아주는 데스크톱 애플리케이션을 개발해줘.

## 핵심 요구사항 (우선순위 순)

### 1. 빠르고 정확한 텍스트 인식 (최우선)
- **화면 캡처 및 OCR**
  - 게임 화면의 특정 영역을 실시간으로 캡처
  - OCR을 통해 문제 텍스트를 추출
  - **정확도**: 오타 없이 문제를 정확하게 인식 (99% 이상 목표)
  - **속도**: 화면 캡처 → 텍스트 인식 → 답 검색까지 1초 이내
  
- **OCR 최적화 전략**
  - 한글 인식에 최적화된 OCR 엔진 사용 (Tesseract OCR + 한글 학습 데이터, 또는 네이버 Clova OCR, Google Cloud Vision API 등)
  - 게임 화면의 폰트, 색상, 배경에 맞춰 전처리 (명암 조정, 노이즈 제거, 이진화)
  - 문제 영역만 정확히 캡처하도록 ROI(Region of Interest) 설정 기능
  - 여러 OCR 결과를 비교하여 가장 정확한 결과 선택하는 앙상블 방식 고려

- **실시간 인식**
  - **단축키 모드**: 단축키로 즉시 화면 캡처 (예: F9) - 일회성
  - **자동 검색 모드** (핵심 기능):
    - [시작] 버튼 클릭 시 연속 인식 시작
    - 설정된 간격(기본 1초)마다 자동으로 화면 캡처 + OCR + 검색
    - 문제가 변경되면 자동으로 새 답 표시
    - [일시정지] 버튼으로 언제든 멈출 수 있음
    - 백그라운드에서 계속 실행
  - 문제가 동일하면 재검색하지 않음 (성능 최적화)

### 2. 초고속 답 검색
- **검색 알고리즘**
  - JSON 파일 (all_questions.json)을 메모리에 로드하여 빠른 검색
  - 문자열 유사도 매칭 (완전 일치 우선, 부분 일치, 퍼지 매칭 순서)
  - OCR 오류를 감안한 유사 문제 검색 (Levenshtein distance, TF-IDF 등)
  - 공백, 특수문자 무시 옵션
  
- **검색 최적화**
  - 해시 테이블 또는 Trie 자료구조 활용
  - 인덱싱으로 검색 속도 0.1초 이내 달성
  - 게임별 필터링으로 검색 범위 축소

### 3. 사용자 인터페이스
- **메인 화면 (오버레이 방식)**
  - 항상 최상단에 띄워진 작고 심플한 창
  - **투명도 조절 가능** (슬라이더: 10% ~ 100%)
    - 게임 화면 위에 겹쳐서 표시되므로 투명도로 게임 방해 최소화
    - 기본값: 80% (게임 화면이 살짝 비치면서 답은 명확히 보임)
  - 인식된 문제와 답을 크고 명확하게 표시
  - 현재 선택된 게임 표시
  - 답 복사 버튼 (클립보드에 자동 복사)
  - **자동 검색 제어 버튼** (크고 명확하게)
    - [시작] 버튼: 연속 자동 인식 모드 시작 (초록색)
    - [일시정지] 버튼: 자동 인식 멈춤 (빨간색)
    - 상태 표시: "자동 검색 중..." / "일시정지됨"

- **영역 설정 화면 (최초 설정 필수)**
  - **문제 영역 지정 Flow:**
    1. "영역 설정" 버튼 클릭
    2. 화면이 반투명 어두워지며 전체 화면 캡처
    3. 마우스 드래그로 문제가 표시되는 영역 선택
    4. 선택 영역이 빨간 사각형으로 표시됨
    5. "확인" 버튼으로 영역 저장
    6. 미리보기로 설정된 영역 확인 가능
  - **여러 게임의 영역 저장**
    - 게임별로 다른 영역 설정 및 저장
    - 게임 전환 시 자동으로 해당 영역 적용
  - **영역 조정**
    - 저장된 영역을 수동으로 미세 조정 (X, Y, Width, Height)
    - "영역 테스트" 버튼으로 현재 영역 캡처 및 OCR 테스트

- **설정 화면**
  - 게임 선택 (꽁꽁, 올라올라, OX, 가로세로)
  - 투명도 조절 (슬라이더)
  - OCR 전처리 옵션 (명암, 대비, 임계값)
  - 자동 검색 간격 설정 (0.5초 ~ 5초, 기본 1초)
  - 단축키 커스터마이징

- **결과 표시 방식**
  - 인식된 문제 (색상: 파란색, 작은 폰트)
  - 정답 (색상: 초록색, 큰 폰트, 굵게)
  - 신뢰도 표시 (OCR 인식률, 검색 매칭률)
  - 여러 답이 있는 경우 모두 표시 (예: "상파울로 / 상파울루")
  - 마지막 업데이트 시간 표시

### 4. 문제/답 추가 기능
- **수동 추가**
  - 간단한 폼으로 문제와 답 입력
  - 게임 카테고리 선택
  - JSON 파일에 자동 저장

- **자동 학습**
  - 인식된 문제 중 답을 못 찾은 경우 기록
  - 사용자가 답을 입력하면 자동으로 데이터베이스에 추가
  - "이 문제 추가하기" 버튼

### 5. 부가 기능
- **통계**
  - 인식 성공률
  - 평균 인식 속도
  - 게임별 사용 빈도

- **로그**
  - 인식된 문제/답 히스토리
  - 실패한 인식 기록 (디버깅용)

## 기술 스택 권장사항

### OCR
**중요: OCR 엔진은 프로그램에 내장되어야 함 (배포 대상)**

1. **Tesseract OCR** (추천 - 무료, 오프라인, 배포 가능)
   - 장점: 빠름, 로컬 처리, 무료, 사용자 API 키 불필요
   - 한글 학습 데이터: `kor.traineddata` (프로그램에 포함)
   - Python: `pytesseract` 라이브러리
   - **배포 방법**: Tesseract 실행 파일과 학습 데이터를 프로그램 폴더에 포함
   - 설치 경로: `./tesseract/` 또는 프로그램 내부 리소스

2. **EasyOCR** (대안 - 무료, 딥러닝 기반)
   - 장점: 설치 간편, 고정확도, API 키 불필요
   - Python: `easyocr` 라이브러리
   - 모델 파일도 프로그램에 포함 가능

**API 기반 OCR은 사용하지 않음** (네이버 Clova, Google Vision 등)
- 사용자가 API 키를 설정해야 하는 번거로움
- 배포 후 사용자 환경에서 바로 동작해야 함

### 프로그래밍 언어
- **Python** 추천
  - OCR 라이브러리 풍부
  - GUI: PyQt5 또는 Tkinter
  - 화면 캡처: `pyautogui`, `mss`
  - 전역 단축키: `keyboard`, `pynput`

- **C# / .NET** (대안)
  - Windows Forms 또는 WPF
  - 빠른 성능
  - Tesseract.NET

### 데이터 관리
- JSON 파일 (all_questions.json) 메모리 로드
- SQLite (선택사항, 대용량 데이터 시)

## 개발 우선순위

### Phase 1: 핵심 기능 (MVP)
1. **영역 설정 기능** (최우선)
   - 드래그로 화면 영역 선택 UI
   - 선택 영역 저장 및 불러오기
2. **자동 검색 모드**
   - [시작]/[일시정지] 버튼
   - 설정 간격마다 자동 캡처+인식+검색
3. Tesseract OCR 내장
4. JSON 파일에서 답 검색
5. 투명도 조절 가능한 오버레이 UI

### Phase 2: 최적화
1. OCR 전처리로 정확도 향상
2. 검색 알고리즘 최적화로 속도 향상
3. 유사 문제 검색 (퍼지 매칭)
4. 이전 문제 캐싱으로 중복 검색 방지

### Phase 3: 사용성 개선
1. 게임별 영역 프리셋 저장
2. 답 자동 복사
3. 자동 검색 간격 조절
4. 영역 테스트 기능

### Phase 4: 확장 기능
1. 문제/답 추가 기능
2. 통계 및 로그
3. 자동 학습

## 성능 목표
- **인식 정확도**: 95% 이상 (깨끗한 화면 기준)
- **전체 처리 시간**: 1초 이내
  - 화면 캡처: 0.1초
  - OCR 처리: 0.5초
  - 답 검색: 0.1초
  - UI 업데이트: 0.1초
- **메모리 사용량**: 100MB 이하

## 주의사항
1. **OCR 정확도가 핵심**: 문제를 정확히 읽지 못하면 답을 찾을 수 없음
2. **전처리가 중요**: 게임 화면의 특성(폰트, 색상, 배경)에 맞춘 이미지 전처리 필수
3. **퍼지 매칭**: OCR 오류를 감안한 유사도 검색 알고리즘 필요
4. **사용자 경험**: 빠르고 간편하게, 게임 플레이를 방해하지 않도록
5. **배포 고려**: API 키 없이 standalone으로 동작해야 함
6. **자동 검색 최적화**: 
   - 이전 문제와 동일하면 재검색 안 함
   - 검색 간격을 너무 짧게 하면 CPU 부하 증가
   - 기본 1초가 적당함
7. **투명도 UI**: 게임 화면 위에 겹치므로 투명도가 핵심 기능

## 시작 가이드
1. 영역 선택 UI 먼저 구현 (드래그 앤 드롭)
2. Tesseract OCR 내장 및 테스트
3. 게임 화면으로 OCR 테스트하여 최적의 전처리 방법 찾기
4. 자동 검색 루프 구현 ([시작]/[일시정지])
5. JSON 데이터 로드 및 검색 기능 구현
6. 투명도 조절 가능한 오버레이 GUI 연결
7. 성능 최적화 및 사용성 개선
8. PyInstaller로 EXE 빌드 및 배포 테스트

## 주요 사용 흐름 (User Flow)

### 최초 실행 시
1. 프로그램 실행
2. "영역 설정이 필요합니다" 안내 메시지
3. [영역 설정] 버튼 클릭
4. 게임 화면으로 이동 후 문제 영역을 드래그로 선택
5. [확인] 버튼으로 저장
6. 메인 화면으로 돌아옴

### 게임 플레이 중
1. 게임 실행 (예: 꽁꽁)
2. 프로그램의 투명도를 적절히 조절 (게임 화면이 보이도록)
3. [시작] 버튼 클릭 → **자동 검색 모드 시작**
4. 프로그램이 1초마다 자동으로:
   - 설정된 영역 캡처
   - OCR로 문제 인식
   - 답 검색
   - 화면에 답 표시
5. 게임 중 답을 보면서 플레이
6. 쉬는 시간에 [일시정지] 클릭
7. 다시 시작할 때 [시작] 클릭

### 다른 게임으로 전환 시
1. 게임 선택 드롭다운에서 새 게임 선택
2. 해당 게임의 저장된 영역 자동 로드
3. (영역이 없으면) 영역 설정 진행
4. [시작] 버튼으로 자동 검색 재개



## 예상 파일 구조
```
quiz-helper/
├── main.py                    # 메인 프로그램
├── ocr_engine.py              # OCR 처리 (Tesseract 내장)
├── search_engine.py           # 답 검색 로직
├── region_selector.py         # 영역 선택 UI
├── auto_search_manager.py     # 자동 검색 루프 관리
├── ui/
│   ├── main_window.py         # 메인 UI (투명도 조절)
│   ├── overlay_window.py      # 오버레이 윈도우
│   └── settings.py            # 설정 UI
├── data/
│   ├── all_questions.json     # 문제 데이터베이스
│   ├── user_added.json        # 사용자 추가 문제
│   └── regions.json           # 게임별 저장된 영역 정보
├── tesseract/                 # Tesseract OCR 내장
│   ├── tesseract.exe          # (Windows)
│   └── tessdata/
│       └── kor.traineddata    # 한글 학습 데이터
├── requirements.txt
└── README.md
```

## 배포 고려사항
1. **Tesseract 포함**: 프로그램 폴더에 Tesseact 실행파일과 데이터 포함
2. **PyInstaller로 EXE 빌드**: 사용자는 설치 없이 실행 가능
3. **리소스 번들링**: JSON 파일, Tesseract 데이터 모두 포함
4. **자동 업데이트**: 문제 데이터베이스 업데이트 기능 (선택사항)

---

이 프롬프트를 바탕으로 **정확도와 속도에 최우선으로 집중한** 퀴즈 자동 답변 프로그램을 개발해줘.

특히 **OCR 정확도를 극대화하는 전처리 방법**과 **초고속 검색 알고리즘**에 신경써서 구현해줘.